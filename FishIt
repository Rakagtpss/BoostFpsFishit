local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local Lighting = game:GetService("Lighting")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local VirtualUser = game:GetService("VirtualUser")

-- // Compatibility Helper
local fireproximityprompt = fireproximityprompt or function(Obj)
    if Obj:IsA("ProximityPrompt") then
        Obj:InputHoldBegin()
        task.wait(Obj.HoldDuration)
        Obj:InputHoldEnd()
    end
end

local Player = Players.LocalPlayer
local SelectedItem = ""

-- // Toggles
local Toggles = {
    AutoPrompt = false,
    AutoYes = false,
    Booster = false,
    Instant = false,
    Minimized = false
}

-- // UI Setup (Lightweight)
if CoreGui:FindFirstChild("SeraphinV10") then CoreGui.SeraphinV10:Destroy() end

local Gui = Instance.new("ScreenGui", CoreGui)
Gui.Name = "SeraphinV10"

local Main = Instance.new("Frame", Gui)
Main.Size = UDim2.new(0, 260, 0, 420)
Main.Position = UDim2.new(0.5, -130, 0.2, 0)
Main.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
Main.BorderSizePixel = 0
Main.Active = true
Main.Draggable = true
Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 6)

-- Header
local Header = Instance.new("Frame", Main)
Header.Size = UDim2.new(1, 0, 0, 30)
Header.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Instance.new("UICorner", Header)

local Title = Instance.new("TextLabel", Header)
Title.Size = UDim2.new(1, -50, 1, 0)
Title.Position = UDim2.new(0, 10, 0, 0)
Title.Text = "SERAPHIN LIGHT V10"
Title.TextColor3 = Color3.new(0, 1, 0.7)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 12
Title.BackgroundTransparency = 1
Title.TextXAlignment = Enum.TextXAlignment.Left

local MinBtn = Instance.new("TextButton", Header)
MinBtn.Size = UDim2.new(0, 40, 0, 20)
MinBtn.Position = UDim2.new(1, -45, 0.5, -10)
MinBtn.Text = "_"
MinBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
MinBtn.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", MinBtn)

local Scroll = Instance.new("ScrollingFrame", Main)
Scroll.Size = UDim2.new(1, -10, 1, -40)
Scroll.Position = UDim2.new(0, 5, 0, 35)
Scroll.BackgroundTransparency = 1
Scroll.ScrollBarThickness = 0
Scroll.CanvasSize = UDim2.new(0, 0, 0, 550)

local Layout = Instance.new("UIListLayout", Scroll)
Layout.Padding = UDim.new(0, 5)
Layout.HorizontalAlignment = Enum.HorizontalAlignment.Center

-- Helper: Lightweight Button
local function AddBtn(text, callback)
    local b = Instance.new("TextButton", Scroll)
    b.Size = UDim2.new(0.95, 0, 0, 32)
    b.Text = text
    b.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    b.TextColor3 = Color3.fromRGB(200, 200, 200)
    b.Font = Enum.Font.Gotham
    b.TextSize = 11
    Instance.new("UICorner", b)
    
    b.MouseButton1Click:Connect(function()
        callback(b)
    end)
    return b
end

-- --- 1. SCAN GEARS SECTION ---
local ListFrame = Instance.new("ScrollingFrame", Scroll)
ListFrame.Size = UDim2.new(0.95, 0, 0, 100)
ListFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
ListFrame.ScrollBarThickness = 2
Instance.new("UIListLayout", ListFrame)

local SelDisplay = Instance.new("TextLabel", Scroll)
SelDisplay.Size = UDim2.new(0.95, 0, 0, 20)
SelDisplay.Text = "Selected: None"
SelDisplay.TextColor3 = Color3.new(0.7, 0.7, 0.7)
SelDisplay.BackgroundTransparency = 1
SelDisplay.TextSize = 10

AddBtn("SCAN GEARS (Collection)", function(b)
    for _, c in pairs(ListFrame:GetChildren()) do if c:IsA("TextButton") then c:Destroy() end end
    local path = ReplicatedStorage:FindFirstChild("Modules")
    if path then path = path:FindFirstChild("ModelDownloader") end
    if path then path = path:FindFirstChild("Collection") end
    if path then path = path:FindFirstChild("Gears") end
    
    if path then
        for _, gear in pairs(path:GetChildren()) do
            local gBtn = Instance.new("TextButton", ListFrame)
            gBtn.Size = UDim2.new(1, 0, 0, 20)
            gBtn.Text = gear.Name
            gBtn.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
            gBtn.TextColor3 = Color3.new(1,1,1)
            gBtn.TextSize = 10
            gBtn.MouseButton1Click:Connect(function()
                SelectedItem = gear.Name
                SelDisplay.Text = "Selected: " .. gear.Name
            end)
        end
    end
end)

AddBtn("SELL SELECTED (Remote)", function()
    if SelectedItem ~= "" then
        pcall(function()
            ReplicatedStorage.Packages._Index["sleitnick_net@0.2.0"].net["RF/SellItem"]:InvokeServer(SelectedItem)
        end)
    end
end)

-- --- 2. AUTO SELL PROMPT ---
AddBtn("AUTO PROMPT: OFF", function(b)
    Toggles.AutoPrompt = not Toggles.AutoPrompt
    b.Text = Toggles.AutoPrompt and "AUTO PROMPT: ON" or "AUTO PROMPT: OFF"
    b.TextColor3 = Toggles.AutoPrompt and Color3.new(0,1,0.5) or Color3.new(0.8,0.8,0.8)
    task.spawn(function()
        while Toggles.AutoPrompt do
            pcall(function()
                local p = workspace["!!! DEPENDENCIES"]:GetChildren()[4].SellPrompt.SellPrompt
                fireproximityprompt(p)
            end)
            task.wait(0.3)
        end
    end)
end)

-- --- 3. AUTO YES CLICKER ---
AddBtn("AUTO YES: OFF", function(b)
    Toggles.AutoYes = not Toggles.AutoYes
    b.Text = Toggles.AutoYes and "AUTO YES: ON" or "AUTO YES: OFF"
    b.TextColor3 = Toggles.AutoYes and Color3.new(0,1,0.5) or Color3.new(0.8,0.8,0.8)
    task.spawn(function()
        while Toggles.AutoYes do
            pcall(function()
                for _, v in pairs(Player.PlayerGui:GetDescendants()) do
                    if v:IsA("TextButton") and v.Text:lower() == "yes" and v.Visible then
                        VirtualUser:ClickButton1(Vector2.new(0,0)) -- Basic click trigger
                        v:Activate() -- Direct trigger
                    end
                end
            end)
            task.wait(0.4)
        end
    end)
end)

-- --- 4. UTILITIES (Old Features) ---
AddBtn("BOOSTER MODE: OFF", function(b)
    Toggles.Booster = not Toggles.Booster
    b.Text = Toggles.Booster and "BOOSTER: ON" or "BOOSTER: OFF"
    Lighting.GlobalShadows = not Toggles.Booster
    if Toggles.Booster then
        for _, v in pairs(game:GetDescendants()) do
            if v:IsA("BasePart") then v.Material = "SmoothPlastic" elseif v:IsA("Texture") then v.Transparency = 1 end
        end
    end
end)

AddBtn("INSTANT PROMPT: OFF", function(b)
    Toggles.Instant = not Toggles.Instant
    b.Text = Toggles.Instant and "INSTANT: ON" or "INSTANT: OFF"
    task.spawn(function()
        while Toggles.Instant do
            for _, p in pairs(workspace:GetDescendants()) do
                if p:IsA("ProximityPrompt") then p.HoldDuration = 0 end
            end
            task.wait(2)
        end
    end)
end)

-- --- MINIMIZE ---
MinBtn.MouseButton1Click:Connect(function()
    Toggles.Minimized = not Toggles.Minimized
    Main:TweenSize(Toggles.Minimized and UDim2.new(0, 260, 0, 30) or UDim2.new(0, 260, 0, 420), "Out", "Quart", 0.2, true)
    Scroll.Visible = not Toggles.Minimized
end)

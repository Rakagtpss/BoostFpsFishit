--[[ SERAPHIN HELPER: FLOATING HUD + TOGGLE SWITCH ]]--
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local Lighting = game:GetService("Lighting")
local TeleportService = game:GetService("TeleportService")

-- // Setup & Safety
local Player = Players.LocalPlayer
local Char = Player.Character or Player.CharacterAdded:Wait()
local HRP = Char:WaitForChild("HumanoidRootPart", 5)
if not HRP then return end 

-- // Konfigurasi Tampilan
local UI_CONFIG = {
    Width = 460,        
    Height = 320,       -- [UPDATE] Tinggi pas untuk 5 Baris (10 Tombol)
    Color = Color3.fromRGB(10, 10, 12), 
    HeaderColor = Color3.fromRGB(15, 15, 18),
    Accent = Color3.fromRGB(0, 255, 170), -- Neon Cyan
    StatsColor = Color3.fromRGB(20, 20, 25),
    TextColor = Color3.fromRGB(240, 240, 240),
    Font = Enum.Font.GothamBold,
    BtnFont = Enum.Font.GothamMedium
}

-- // Cleanup UI Lama
if CoreGui:FindFirstChild("SeraphinHelper") then CoreGui.SeraphinHelper:Destroy() end

-- // Main ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "SeraphinHelper"
ScreenGui.Parent = CoreGui
ScreenGui.ResetOnSpawn = false

-- ==========================================
-- [1] FLOATING STATS PANEL (HUD)
-- ==========================================
local FloatHUD = Instance.new("Frame", ScreenGui)
FloatHUD.Name = "FloatingStats"
FloatHUD.Size = UDim2.new(0, 260, 0, 36)
FloatHUD.Position = UDim2.new(0.5, -130, 0.1, 0)
FloatHUD.BackgroundColor3 = UI_CONFIG.StatsColor
FloatHUD.BackgroundTransparency = 0.2
FloatHUD.Active = true
FloatHUD.Draggable = true 
FloatHUD.Visible = true -- Default ON
FloatHUD.BorderSizePixel = 0

Instance.new("UICorner", FloatHUD).CornerRadius = UDim.new(0, 8)
local HudStroke = Instance.new("UIStroke", FloatHUD)
HudStroke.Color = UI_CONFIG.Accent
HudStroke.Thickness = 1.5
HudStroke.Transparency = 0.4

local FishStat = Instance.new("TextLabel", FloatHUD)
FishStat.Size = UDim2.new(0.5, -5, 1, 0)
FishStat.Position = UDim2.new(0, 10, 0, 0)
FishStat.BackgroundTransparency = 1
FishStat.Text = "üêü: Loading..."
FishStat.TextColor3 = UI_CONFIG.Accent
FishStat.Font = Enum.Font.GothamBold
FishStat.TextSize = 13
FishStat.TextXAlignment = Enum.TextXAlignment.Left

local BagStat = Instance.new("TextLabel", FloatHUD)
BagStat.Size = UDim2.new(0.5, -10, 1, 0)
BagStat.Position = UDim2.new(0.5, 0, 0, 0)
BagStat.BackgroundTransparency = 1
BagStat.Text = "üéí: Loading..."
BagStat.TextColor3 = Color3.fromRGB(230, 230, 230)
BagStat.Font = Enum.Font.GothamBold
BagStat.TextSize = 13
BagStat.TextXAlignment = Enum.TextXAlignment.Right

-- ==========================================
-- [2] MAIN MENU CONTAINER
-- ==========================================
local Main = Instance.new("Frame", ScreenGui)
Main.Name = "Main"
Main.Size = UDim2.new(0, UI_CONFIG.Width, 0, UI_CONFIG.Height)
Main.Position = UDim2.new(0.5, -UI_CONFIG.Width/2, 0.35, 0)
Main.BackgroundColor3 = UI_CONFIG.Color
Main.BackgroundTransparency = 0.05
Main.BorderSizePixel = 0
Main.Active = true
Main.Draggable = true
Main.ClipsDescendants = true 

Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 10)
local MainStroke = Instance.new("UIStroke", Main)
MainStroke.Color = UI_CONFIG.Accent
MainStroke.Thickness = 1.5
MainStroke.Transparency = 0.3

-- // Header Section
local Header = Instance.new("Frame", Main)
Header.Size = UDim2.new(1, 0, 0, 40)
Header.BackgroundColor3 = UI_CONFIG.HeaderColor
Header.BorderSizePixel = 0
Instance.new("UICorner", Header).CornerRadius = UDim.new(0, 10)

local HeaderFiller = Instance.new("Frame", Header)
HeaderFiller.Size = UDim2.new(1, 0, 0.5, 0)
HeaderFiller.Position = UDim2.new(0, 0, 0.5, 0)
HeaderFiller.BackgroundColor3 = UI_CONFIG.HeaderColor
HeaderFiller.BorderSizePixel = 0

-- JUDUL
local Title = Instance.new("TextLabel", Header)
Title.Size = UDim2.new(1, 0, 1, 0)
Title.Position = UDim2.new(0, 0, 0, 0)
Title.Text = "SERAPHIN <font color=\"rgb(0,255,170)\">HELPER</font>"
Title.RichText = true
Title.TextColor3 = Color3.new(1,1,1)
Title.Font = UI_CONFIG.Font
Title.TextSize = 14
Title.BackgroundTransparency = 1
Title.TextXAlignment = Enum.TextXAlignment.Center

-- FPS Counter
local FpsLbl = Instance.new("TextLabel", Header)
FpsLbl.Size = UDim2.new(0.2, 0, 1, 0)
FpsLbl.Position = UDim2.new(0.03, 0, 0, 0)
FpsLbl.Text = "60 FPS"
FpsLbl.TextColor3 = UI_CONFIG.Accent
FpsLbl.Font = Enum.Font.GothamBlack
FpsLbl.TextSize = 13
FpsLbl.BackgroundTransparency = 1
FpsLbl.TextXAlignment = Enum.TextXAlignment.Left

-- Hide Button
local HideBtn = Instance.new("TextButton", Header)
HideBtn.Size = UDim2.new(0, 50, 0, 24)
HideBtn.Position = UDim2.new(0.87, 0, 0.5, -12)
HideBtn.Text = "HIDE"
HideBtn.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
HideBtn.TextColor3 = Color3.new(1,1,1)
HideBtn.Font = UI_CONFIG.Font
HideBtn.TextSize = 10
Instance.new("UICorner", HideBtn).CornerRadius = UDim.new(0, 6)
local HideStroke = Instance.new("UIStroke", HideBtn)
HideStroke.Color = UI_CONFIG.Accent
HideStroke.Thickness = 1
HideStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

-- // Content Grid
local Container = Instance.new("Frame", Main)
Container.Size = UDim2.new(1, -24, 1, -45) 
Container.Position = UDim2.new(0, 12, 0, 45)
Container.BackgroundTransparency = 1

local Grid = Instance.new("UIGridLayout", Container)
Grid.CellSize = UDim2.new(0, 210, 0, 38) 
Grid.CellPadding = UDim2.new(0, 14, 0, 10)
Grid.HorizontalAlignment = Enum.HorizontalAlignment.Center

-- // Fungsi Helper UI
local function MakeBtn(text)
    local b = Instance.new("TextButton", Container)
    b.Text = text
    b.BackgroundColor3 = Color3.fromRGB(20, 20, 24)
    b.TextColor3 = Color3.fromRGB(200, 200, 200)
    b.Font = UI_CONFIG.BtnFont
    b.TextSize = 11
    b.BackgroundTransparency = 0
    b.AutoButtonColor = true
    
    Instance.new("UICorner", b).CornerRadius = UDim.new(0, 6)
    local s = Instance.new("UIStroke", b)
    s.Color = Color3.fromRGB(50, 50, 55)
    s.Thickness = 1
    s.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    return b
end

local function ToggleVisual(btn, on)
    if on then
        btn.BackgroundColor3 = UI_CONFIG.Accent
        btn.TextColor3 = Color3.new(0,0,0)
        btn.UIStroke.Transparency = 1
    else
        btn.BackgroundColor3 = Color3.fromRGB(20, 20, 24)
        btn.TextColor3 = Color3.fromRGB(200, 200, 200)
        btn.UIStroke.Transparency = 0
    end
end

-- // State & Connections
local States = {Freeze=false, WoW=false, Boost=false, NoRender=false, Noclip=false, Panel=true}
local SavedCFrame = nil 
local Connections = {}
local BodyV = nil

-- // TOMBOL UI (10 Tombol Total - Grid Sempurna)
local BtnFreeze = MakeBtn("Freeze Player")
local BtnWow = MakeBtn("Walk On Water")
local BtnNoclip = MakeBtn("No Clip: OFF")
local BtnBoost = MakeBtn("Booster Mode")
local BtnRender = MakeBtn("3D Rendering: ON")
local BtnFps = MakeBtn("FPS Cap: Unlimited")
local BtnRejoin = MakeBtn("Rejoin Server")
local BtnSave = MakeBtn("Save Position")
local BtnLoad = MakeBtn("Teleport to Saved")
local BtnPanel = MakeBtn("Panel Info: ON") -- [BARU]

-- // LOGIKA BUTTON BARU: PANEL TOGGLE
ToggleVisual(BtnPanel, true) -- Default Nyala
BtnPanel.MouseButton1Click:Connect(function()
    States.Panel = not States.Panel
    FloatHUD.Visible = States.Panel -- Show/Hide Panel
    BtnPanel.Text = "Panel Info: " .. (States.Panel and "ON" or "OFF")
    ToggleVisual(BtnPanel, States.Panel)
end)

-- // LOGIKA STATS UPDATE
task.spawn(function()
    while task.wait(0.5) do
        if not States.Panel then continue end -- Hemat resource kalau panel mati

        -- 1. Update Fish Caught
        pcall(function()
            local leaderstats = Player:FindFirstChild("leaderstats")
            local caught = leaderstats and leaderstats:FindFirstChild("Caught")
            if caught then
                FishStat.Text = "üêü: " .. caught.Value
            else
                FishStat.Text = "üêü: 0"
            end
        end)

        -- 2. Update Backpack
        pcall(function()
            local pg = Player:WaitForChild("PlayerGui", 1)
            local backpackGui = pg and pg:FindFirstChild("Backpack")
            local foundBag = false
            if backpackGui then
                for _, v in pairs(backpackGui:GetDescendants()) do
                    if v:IsA("TextLabel") and string.find(v.Text, "/") then
                        BagStat.Text = "üéí: " .. v.Text
                        foundBag = true
                        break
                    end
                end
            end
            if not foundBag then
                local count = #Player.Backpack:GetChildren()
                BagStat.Text = "üéí: " .. count
            end
        end)
    end
end)

-- // LOGIKA FITUR UTAMA LAINNYA

-- Freeze
BtnFreeze.MouseButton1Click:Connect(function()
    States.Freeze = not States.Freeze
    if HRP then HRP.Anchored = States.Freeze end
    ToggleVisual(BtnFreeze, States.Freeze)
end)

-- Walk On Water
BtnWow.MouseButton1Click:Connect(function()
    States.WoW = not States.WoW
    ToggleVisual(BtnWow, States.WoW)
    if States.WoW then
        BodyV = Instance.new("BodyVelocity", HRP)
        BodyV.MaxForce = Vector3.new(0, 1e6, 0)
        BodyV.Velocity = Vector3.zero
        Connections["WoW"] = RunService.Heartbeat:Connect(function()
            if HRP then HRP.AssemblyLinearVelocity = Vector3.new(HRP.AssemblyLinearVelocity.X, 0, HRP.AssemblyLinearVelocity.Z) end
        end)
    else
        if Connections["WoW"] then Connections["WoW"]:Disconnect() end
        if BodyV then BodyV:Destroy() end
    end
end)

-- No Clip
BtnNoclip.MouseButton1Click:Connect(function()
    States.Noclip = not States.Noclip
    BtnNoclip.Text = "No Clip: " .. (States.Noclip and "ON" or "OFF")
    ToggleVisual(BtnNoclip, States.Noclip)
    
    if States.Noclip then
        Connections["Noclip"] = RunService.Stepped:Connect(function()
            if Player.Character then
                for _, v in pairs(Player.Character:GetDescendants()) do
                    if v:IsA("BasePart") and v.CanCollide == true then
                        v.CanCollide = false
                    end
                end
            end
        end)
    else
        if Connections["Noclip"] then Connections["Noclip"]:Disconnect() end
    end
end)

-- Booster Mode
BtnBoost.MouseButton1Click:Connect(function()
    States.Boost = not States.Boost
    ToggleVisual(BtnBoost, States.Boost)
    BtnBoost.Text = States.Boost and "Booster: ACTIVE" or "Booster Mode"
    Lighting.GlobalShadows = not States.Boost
    local targets = {}
    table.insert(targets, workspace)
    local function AddIfExist(parent, name) local t = parent:FindFirstChild(name) if t then table.insert(targets, t) return t end end
    AddIfExist(workspace, "!!! EFFECTS")
    AddIfExist(workspace, "Machines")
    AddIfExist(workspace, "TrainSystem")
    local islands = workspace:FindFirstChild("Islands")
    if islands then
        local decor = AddIfExist(islands, "ChristmasDecor [Fisheman Island]")
        if decor then AddIfExist(decor, "SnowBenchs") AddIfExist(decor, "Snow") AddIfExist(decor, "ChristmasLightRopes") end
        local jungle = islands:FindFirstChild("Ancient Jungle")
        if jungle then local children = jungle:GetChildren() if children[25] then table.insert(targets, children[25]) end end
    end
    for _, root in pairs(targets) do
        local isHeavy = (root.Name == "!!! EFFECTS" or root.Name == "Snow" or root.Name == "ChristmasLightRopes")
        for _, v in pairs(root:GetDescendants()) do
            if States.Boost then
                if isHeavy then
                    if v:IsA("BasePart") then v.Transparency = 1 v.CanCollide = false end
                    if v:IsA("ParticleEmitter") or v:IsA("Light") then v.Enabled = false end
                else
                    if v:IsA("BasePart") then v.Material = Enum.Material.SmoothPlastic v.CastShadow = false end
                    if v:IsA("Decal") or v:IsA("Texture") then v.Transparency = 1 end
                    if v:IsA("ParticleEmitter") then v.Enabled = false end
                    if v:IsA("Sound") then v:Pause() end
                end
            else
                if isHeavy then
                    if v:IsA("BasePart") then v.Transparency = 0 end
                    if v:IsA("ParticleEmitter") or v:IsA("Light") then v.Enabled = true end
                else
                    if v:IsA("BasePart") then v.CastShadow = true end
                    if v:IsA("Decal") or v:IsA("Texture") then v.Transparency = 0 end
                    if v:IsA("ParticleEmitter") then v.Enabled = true end
                    if v:IsA("Sound") then v:Play() end
                end
            end
        end
    end
end)

-- Render & FPS
BtnRender.MouseButton1Click:Connect(function()
    States.NoRender = not States.NoRender
    RunService:Set3dRenderingEnabled(not States.NoRender)
    BtnRender.Text = "3D Rendering: " .. (States.NoRender and "OFF" or "ON")
    ToggleVisual(BtnRender, States.NoRender)
end)

BtnFps.MouseButton1Click:Connect(function()
    local limits = {30, 60, 144, 999}
    _G.limitIdx = ((_G.limitIdx or 4) % #limits) + 1
    local val = limits[_G.limitIdx]
    if setfpscap then setfpscap(val) end
    BtnFps.Text = "FPS Cap: " .. (val > 900 and "Unlimited" or val)
end)

-- Rejoin & Teleport
BtnRejoin.MouseButton1Click:Connect(function() TeleportService:Teleport(game.PlaceId, Player) end)

BtnSave.MouseButton1Click:Connect(function()
    if HRP then
        SavedCFrame = HRP.CFrame
        BtnSave.Text = "Position Saved!"
        ToggleVisual(BtnSave, true)
        wait(1)
        ToggleVisual(BtnSave, false)
        BtnSave.Text = "Save Position"
    end
end)

BtnLoad.MouseButton1Click:Connect(function()
    if SavedCFrame and HRP then
        HRP.CFrame = SavedCFrame
        ToggleVisual(BtnLoad, true)
        wait(0.5)
        ToggleVisual(BtnLoad, false)
    end
end)

-- Logic Hide UI
local IsMin = false
HideBtn.MouseButton1Click:Connect(function()
    IsMin = not IsMin
    Main:TweenSize(UDim2.new(0, UI_CONFIG.Width, 0, IsMin and 40 or UI_CONFIG.Height), "Out", "Quad", 0.25, true)
    Container.Visible = not IsMin
    HideBtn.Text = IsMin and "SHOW" or "HIDE"
end)

-- FPS Loop
local last, f = os.clock(), 0
RunService.RenderStepped:Connect(function()
    f += 1
    if os.clock() - last >= 1 then
        FpsLbl.Text = f .. " FPS"
        f, last = 0, os.clock()
    end
end)

print(":: SERAPHIN HELPER LOADING ::")

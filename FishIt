--[[ 
 RakaGanteng UI - V10 (2026 FINAL UPDATE)
 Feature: Smart Event Scanner & Auto-Follow (Real-time Tracking)
 Optimized for: FISH IT
]]

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local VU = game:GetService("VirtualUser")

local Player = Players.LocalPlayer
local Char = Player.Character or Player.CharacterAdded:Wait()
local HRP = Char:WaitForChild("HumanoidRootPart")

-- State Variables
local AutoEvent = false
local WOW_Enabled = false
local NoRender_Enabled = false
local IsMinimized = false
local BV, Conn

-- Anti-AFK
Player.Idled:Connect(function()
    VU:CaptureController()
    VU:ClickButton2(Vector2.new())
end)

-- UI Setup (Modern 2026 - 280px)
local Gui = Instance.new("ScreenGui", game.CoreGui)
Gui.Name = "RakaGanteng_Final_Scan"

-- Draggable Logo
local MinBtn = Instance.new("TextButton", Gui)
MinBtn.Size = UDim2.new(0, 38, 0, 38)
MinBtn.Position = UDim2.new(0, 15, 0.5, -19)
MinBtn.BackgroundColor3 = Color3.fromRGB(2, 10, 30)
MinBtn.Text = "R"
MinBtn.Font = Enum.Font.GothamBold
MinBtn.TextColor3 = Color3.fromRGB(0, 255, 255)
MinBtn.TextSize = 20
MinBtn.Draggable = true
Instance.new("UICorner", MinBtn).CornerRadius = UDim.new(1, 0)
local MStroke = Instance.new("UIStroke", MinBtn)
MStroke.Color = Color3.fromRGB(0, 150, 255)
MStroke.Thickness = 2

-- Main Frame
local Frame = Instance.new("Frame", Gui)
Frame.Size = UDim2.new(0, 280, 0, 165)
Frame.Position = UDim2.new(0.5, -140, 0.4, 0)
Frame.BackgroundColor3 = Color3.fromRGB(5, 10, 20)
Frame.Active = true
Frame.Draggable = true
Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 10)
local FStroke = Instance.new("UIStroke", Frame)
FStroke.Color = Color3.fromRGB(0, 100, 255)
FStroke.Transparency = 0.5

-- Header
local Header = Instance.new("Frame", Frame)
Header.Size = UDim2.new(1, 0, 0, 35)
Header.BackgroundTransparency = 1

local Title = Instance.new("TextLabel", Header)
Title.Size = UDim2.new(1, 0, 1, 0)
Title.Position = UDim2.new(0, 15, 0, 0)
Title.Text = "RAKA GANTENG V10"
Title.TextColor3 = Color3.new(1,1,1)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 13
Title.TextXAlignment = Enum.TextXAlignment.Left

local FPSDisplay = Instance.new("TextLabel", Header)
FPSDisplay.Size = UDim2.new(1, -15, 1, 0)
FPSDisplay.BackgroundTransparency = 1
FPSDisplay.Text = "60 FPS"
FPSDisplay.TextColor3 = Color3.fromRGB(0, 255, 150)
FPSDisplay.Font = Enum.Font.Code
FPSDisplay.TextSize = 12
FPSDisplay.TextXAlignment = Enum.TextXAlignment.Right

-- Buttons Grid
local BtnGrid = Instance.new("Frame", Frame)
BtnGrid.Size = UDim2.new(1, -20, 0, 80)
BtnGrid.Position = UDim2.new(0, 10, 0, 45)
BtnGrid.BackgroundTransparency = 1

local Layout = Instance.new("UIGridLayout", BtnGrid)
Layout.CellSize = UDim2.new(0, 125, 0, 32)
Layout.CellPadding = UDim2.new(0, 10, 0, 10)
Layout.HorizontalAlignment = Enum.HorizontalAlignment.Center

local function CreateBtn(text)
    local B = Instance.new("TextButton", BtnGrid)
    B.Text = text
    B.Font = Enum.Font.GothamBold
    B.TextSize = 11
    B.TextColor3 = Color3.fromRGB(200, 200, 200)
    B.BackgroundColor3 = Color3.fromRGB(15, 25, 45)
    Instance.new("UICorner", B).CornerRadius = UDim.new(0, 8)
    Instance.new("UIStroke", B).Color = Color3.fromRGB(50, 70, 120)
    return B
end

local BtnEvent = CreateBtn("Event Scan: OFF")
local BtnWOW = CreateBtn("Walk Water")
local BtnRender = CreateBtn("No Render")

-- FPS Section
local FPSFrame = Instance.new("Frame", Frame)
FPSFrame.Size = UDim2.new(1, -20, 0, 25)
FPSFrame.Position = UDim2.new(0, 10, 1, -30)
FPSFrame.BackgroundTransparency = 1

local FPSLayout = Instance.new("UIListLayout", FPSFrame)
FPSLayout.FillDirection = Enum.FillDirection.Horizontal
FPSLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
FPSLayout.Padding = UDim.new(0, 5)

local function CreateFPS(val)
    local B = Instance.new("TextButton", FPSFrame)
    B.Size = UDim2.new(0, 45, 1, 0)
    B.Text = tostring(val)
    B.Font = Enum.Font.GothamBold
    B.TextSize = 10
    B.BackgroundColor3 = Color3.fromRGB(10, 15, 30)
    B.TextColor3 = Color3.fromRGB(150, 150, 150)
    Instance.new("UICorner", B).CornerRadius = UDim.new(0, 4)
    B.MouseButton1Click:Connect(function()
        if setfpscap then pcall(function() setfpscap(val) end) end
    end)
end

for _, v in ipairs({30, 60, 120, 240}) do CreateFPS(v) end

------------------------------------------------------
-- LOGIC & SMART SCANNER
------------------------------------------------------

MinBtn.MouseButton1Click:Connect(function()
    IsMinimized = not IsMinimized
    Frame.Visible = not IsMinimized
    MinBtn.Text = IsMinimized and "+" or "R"
end)

-- FPS Monitor
RunService.Heartbeat:Connect(function()
    FPSDisplay.Text = math.floor(1/RunService.Heartbeat:Wait()) .. " FPS"
end)

-- SMART SCAN & AUTO FOLLOW LOGIC
BtnEvent.MouseButton1Click:Connect(function()
    AutoEvent = not AutoEvent
    BtnEvent.Text = AutoEvent and "Scanning..." or "Event Scan: OFF"
    BtnEvent.BackgroundColor3 = AutoEvent and Color3.fromRGB(0, 120, 255) or Color3.fromRGB(15, 25, 45)
    
    task.spawn(function()
        while AutoEvent do
            local found = false
            -- Scanning Workspace for Event Targets
            for _, v in pairs(workspace:GetDescendants()) do
                if v:IsA("Part") or v:IsA("Model") then
                    local n = v.Name:lower()
                    if n:find("meteor") or n:find("event") or n:find("treasure") or n:find("special") then
                        found = true
                        local targetCF = v:IsA("Model") and v:GetModelCFrame() or v.CFrame
                        
                        -- Auto Follow: Terus memperbarui posisi jika objek bergerak
                        HRP.CFrame = targetCF + Vector3.new(0, 5, 0) 
                        BtnEvent.Text = "Following: " .. v.Name
                    end
                end
                if found then break end
            end
            
            if not found then
                BtnEvent.Text = "Searching..."
            end
            task.wait(0.5) -- Scan interval cepat untuk mengikuti pergerakan
        end
    end)
end)

-- Walk On Water
BtnWOW.MouseButton1Click:Connect(function()
    WOW_Enabled = not WOW_Enabled
    BtnWOW.BackgroundColor3 = WOW_Enabled and Color3.fromRGB(0, 120, 255) or Color3.fromRGB(15, 25, 45)
    if WOW_Enabled then
        BV = Instance.new("BodyVelocity", HRP)
        BV.MaxForce = Vector3.new(0, 1e6, 0)
        BV.Velocity = Vector3.zero
        Conn = RunService.PreRender:Connect(function()
            if HRP then HRP.AssemblyLinearVelocity = Vector3.new(HRP.AssemblyLinearVelocity.X, 0, HRP.AssemblyLinearVelocity.Z) end
        end)
    else
        if Conn then Conn:Disconnect() end
        if BV then BV:Destroy() end
    end
end)

-- No Render
BtnRender.MouseButton1Click:Connect(function()
    NoRender_Enabled = not NoRender_Enabled
    RunService:Set3dRenderingEnabled(not NoRender_Enabled)
    BtnRender.BackgroundColor3 = NoRender_Enabled and Color3.fromRGB(0, 120, 255) or Color3.fromRGB(15, 25, 45)
end)

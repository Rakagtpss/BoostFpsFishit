-- FPS Booster & CPU Optimizer with Modern UI & Toggle
-- Place in StarterPlayerScripts or Run via Executor

local RunService = game:GetService("RunService")
local Stats = game:GetService("Stats")
local Lighting = game:GetService("Lighting")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local pGui = player:WaitForChild("PlayerGui")

-- Variables to store original settings
local boosterEnabled = false
local originalSettings = {}

-- 1. FUNGSI OPTIMASI
local function toggleBoost(state)
    boosterEnabled = state
    
    if state then
        -- Simpan settings lama & terapkan optimasi
        Lighting.GlobalShadows = false
        settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
        
        for _, v in pairs(game:GetDescendants()) do
            if v:IsA("PostProcessEffect") or v:IsA("BloomEffect") or v:IsA("BlurEffect") or v:IsA("SunRaysEffect") then
                v.Enabled = false
            elseif v:IsA("BasePart") then
                v.CastShadow = false
            end
        end
    else
        -- Kembalikan ke normal (Sederhana)
        Lighting.GlobalShadows = true
        settings().Rendering.QualityLevel = Enum.QualityLevel.Automatic
        
        for _, v in pairs(game:GetDescendants()) do
            if v:IsA("PostProcessEffect") or v:IsA("BloomEffect") or v:IsA("BlurEffect") or v:IsA("SunRaysEffect") then
                v.Enabled = true
            elseif v:IsA("BasePart") then
                v.CastShadow = true
            end
        end
    end
end

-- 2. MEMBUAT MODERN UI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ModernBoosterUI"
screenGui.Parent = pGui
screenGui.ResetOnSpawn = false

-- Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 180, 0, 110)
mainFrame.Position = UDim2.new(0, 20, 0, 20)
mainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0, 10)
uiCorner.Parent = mainFrame

-- Stats Labels (FPS & PING)
local statsLabel = Instance.new("TextLabel")
statsLabel.Size = UDim2.new(1, -20, 0, 40)
statsLabel.Position = UDim2.new(0, 10, 0, 10)
statsLabel.BackgroundTransparency = 1
statsLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statsLabel.Font = Enum.Font.GothamMedium
statsLabel.TextSize = 14
statsLabel.TextXAlignment = Enum.TextXAlignment.Left
statsLabel.Text = "FPS: --\nPing: -- ms"
statsLabel.Parent = mainFrame

-- Toggle Button
local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(1, -20, 0, 35)
toggleBtn.Position = UDim2.new(0, 10, 0, 60)
toggleBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50) -- Red (OFF)
toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 12
toggleBtn.Text = "BOOSTER: OFF"
toggleBtn.AutoButtonColor = true
toggleBtn.Parent = mainFrame

local btnCorner = Instance.new("UICorner")
btnCorner.CornerRadius = UDim.new(0, 8)
btnCorner.Parent = toggleBtn

-- 3. INTERAKSI & UPDATE LOOP
toggleBtn.MouseButton1Click:Connect(function()
    boosterEnabled = not boosterEnabled
    if boosterEnabled then
        toggleBtn.Text = "BOOSTER: ON"
        toggleBtn.BackgroundColor3 = Color3.fromRGB(50, 200, 100) -- Green
        toggleBoost(true)
    else
        toggleBtn.Text = "BOOSTER: OFF"
        toggleBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50) -- Red
        toggleBoost(false)
    end
end)

-- Real-time Loop
RunService.RenderStepped:Connect(function(dt)
    local fps = math.floor(1 / dt)
    local ping = math.floor(Stats.Network.ServerStatsItem["Data Ping"]:GetValue())
    statsLabel.Text = string.format("FPS: %d\nPing: %d ms", fps, ping)
end)

-- Dragging Functionality (Bisa digeser di layar)
local dragging, dragInput, dragStart, startPos
mainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

mainFrame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

-- ULTIMATE FPS BOOSTER & CPU OPTIMIZER (MODERN UI)
local RunService = game:GetService("RunService")
local Stats = game:GetService("Stats")
local Lighting = game:GetService("Lighting")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local pGui = player:WaitForChild("PlayerGui")

-- Variables
local boosterEnabled = false
local minimized = false

-- 1. FUNGSI OPTIMASI (CORE)
local function applyOptimization(state)
    boosterEnabled = state
    if state then
        Lighting.GlobalShadows = false
        Lighting.OutdoorAmbient = Color3.fromRGB(128, 128, 128)
        settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
        
        for _, v in pairs(game:GetDescendants()) do
            if v:IsA("PostProcessEffect") or v:IsA("BloomEffect") or v:IsA("BlurEffect") or v:IsA("SunRaysEffect") then
                v.Enabled = false
            elseif v:IsA("BasePart") then
                v.CastShadow = false
                if v.Material ~= Enum.Material.Plastic then v.Material = Enum.Material.Plastic end
            elseif v:IsA("ParticleEmitter") or v:IsA("Smoke") or v:IsA("Sparkles") then
                v.Enabled = false
            elseif v:IsA("Decal") or v:IsA("Texture") then
                v.Transparency = 1
            end
        end
    else
        Lighting.GlobalShadows = true
        settings().Rendering.QualityLevel = Enum.QualityLevel.Automatic
        -- Catatan: Untuk mengembalikan material asli butuh penyimpanan tabel data, 
        -- biasanya pemain cukup reset/rejoin untuk kembali ke grafik ultra.
    end
end

-- 2. MEMBUAT MODERN UI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "UltimateBooster"
screenGui.Parent = pGui
screenGui.ResetOnSpawn = false

-- Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 220, 0, 180)
mainFrame.Position = UDim2.new(0.05, 0, 0.4, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
mainFrame.BorderSizePixel = 0
mainFrame.ClipsDescendants = true
mainFrame.Parent = screenGui

local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0, 12)
uiCorner.Parent = mainFrame

local uiStroke = Instance.new("UIStroke")
uiStroke.Color = Color3.fromRGB(45, 45, 45)
uiStroke.Thickness = 2
uiStroke.Parent = mainFrame

-- Title
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 30)
title.BackgroundTransparency = 1
title.Text = "GEMINI BOOSTER"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.GothamBold
title.TextSize = 14
title.Parent = mainFrame

-- Stats (FPS/Ping)
local statsLabel = Instance.new("TextLabel")
statsLabel.Size = UDim2.new(1, -20, 0, 40)
statsLabel.Position = UDim2.new(0, 10, 0, 35)
statsLabel.BackgroundTransparency = 1
statsLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
statsLabel.Font = Enum.Font.Code
statsLabel.TextSize = 13
statsLabel.Text = "FPS: -- | Ping: --"
statsLabel.Parent = mainFrame

-- Toggle Button
local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(1, -30, 0, 35)
toggleBtn.Position = UDim2.new(0, 15, 0, 80)
toggleBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleBtn.Font = Enum.Font.GothamMedium
toggleBtn.TextSize = 12
toggleBtn.Text = "BOOST IS OFF"
toggleBtn.AutoButtonColor = true
toggleBtn.Parent = mainFrame

local btnCorner = Instance.new("UICorner")
btnCorner.CornerRadius = UDim.new(0, 8)
btnCorner.Parent = toggleBtn

-- Clear Lag Button
local clearBtn = Instance.new("TextButton")
clearBtn.Size = UDim2.new(1, -30, 0, 35)
clearBtn.Position = UDim2.new(0, 15, 0, 125)
clearBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
clearBtn.TextColor3 = Color3.fromRGB(0, 170, 255)
clearBtn.Font = Enum.Font.GothamMedium
clearBtn.TextSize = 12
clearBtn.Text = "CLEAR ALL GARBAGE"
clearBtn.Parent = mainFrame

Instance.new("UICorner", clearBtn).CornerRadius = UDim.new(0, 8)

-- 3. INTERAKSI

-- Toggle Function
toggleBtn.MouseButton1Click:Connect(function()
    boosterEnabled = not boosterEnabled
    if boosterEnabled then
        TweenService:Create(toggleBtn, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(0, 180, 100)}):Play()
        toggleBtn.Text = "BOOST IS ACTIVE"
        applyOptimization(true)
    else
        TweenService:Create(toggleBtn, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(40, 40, 40)}):Play()
        toggleBtn.Text = "BOOST IS OFF"
        applyOptimization(false)
    end
end)

-- Clear Garbage Function
clearBtn.MouseButton1Click:Connect(function()
    for _, v in pairs(workspace:GetDescendants()) do
        if v:IsA("Debris") or (v:IsA("BasePart") and v.Transparency == 1 and v.CanCollide == false) then
            v:Destroy()
        end
    end
    clearBtn.Text = "SUCCESSFULLY CLEARED!"
    task.wait(2)
    clearBtn.Text = "CLEAR ALL GARBAGE"
end)

-- Stats Loop
RunService.RenderStepped:Connect(function(dt)
    local fps = math.floor(1 / dt)
    local ping = math.floor(Stats.Network.ServerStatsItem["Data Ping"]:GetValue())
    statsLabel.Text = string.format("FPS: %d | PING: %dms", fps, ping)
    
    -- Color change based on FPS
    if fps < 30 then statsLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
    elseif fps < 50 then statsLabel.TextColor3 = Color3.fromRGB(255, 200, 100)
    else statsLabel.TextColor3 = Color3.fromRGB(100, 255, 100) end
end)

-- Make Draggable
local dragging, dragInput, dragStart, startPos
mainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

mainFrame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
end)

print("Ultimate Booster Loaded!")
